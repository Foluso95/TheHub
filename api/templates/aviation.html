{% extends "base.html" %}
{% block content %}
<div class="glass">
    <h2>Intelligence <span class="accent">Terminal</span></h2>
    <input type="text" id="flightSearch" placeholder="Search City (Lagos), Code (LOS), or Airline (Dana)..."
           style="width: 100%; padding: 15px; margin-bottom: 25px; border-radius: 10px; border: 1px solid var(--accent); background: #020617; color: white;">

    <table style="width: 100%; border-collapse: collapse; text-align: left;">
        <thead style="color: #64748b; font-size: 0.8rem;">
            <tr style="border-bottom: 1px solid #1e293b;"><th style="padding: 1rem 0;">IDENT</th><th>AIRLINE</th><th>ROUTE</th><th>ACTION</th></tr>
        </thead>
        <tbody id="flightTable">
            {% for f in flights %}
            <tr class="flight-row" data-search="{{ f.flight_iata }} {{ f.airline_iata }} {{ f.dep_iata }} {{ f.arr_iata }} DANA AIR PEACE ARIK LAGOS NIGERIA" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                <td style="padding: 1.2rem 0; color: var(--accent); font-weight: bold;">{{ f.flight_iata or 'PRV' }}</td>
                <td>{{ f.airline_iata or 'N/A' }}</td>
                <td>{{ f.dep_iata or '???' }} âž” {{ f.arr_iata or '???' }}</td>
                <td><a href="/checkout" style="background: var(--accent); color: #020617; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-weight: bold; font-size: 0.75rem;">BUY DATA</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
document.getElementById('flightSearch').addEventListener('keyup', function() {
    let filter = this.value.toUpperCase();
    let rows = document.querySelectorAll('.flight-row');
    rows.forEach(row => {
        let searchString = row.getAttribute('data-search') + row.innerText;
        row.style.display = searchString.toUpperCase().includes(filter) ? "" : "none";
    });
});
</script>
{% endblock %}
